const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CharacterDetailModal-D_qhSIkU.js","./index-DYVKctu5.js","./index-DNzuQsQV.css","./CharacterNetworkMap-k2YLkd0I.js","./RelationshipResultView-DtqYq4Uv.js","./zap-D47zeW3z.js","./check-DMXkaoiI.js","./share-2-S1OTWEp_.js","./RadarChart-CPrWotcp.js","./MessageModal-DuKtzDp4.js","./circle-check-Co-gnoo8.js","./circle-alert-DuJTuH7P.js","./save-DCv1ZqEp.js","./palette-BtGilZ2e.js"])))=>i.map(i=>d[i]);
import{c as S,r as l,j as e,A as Mt,S as be,C as ot,_ as It,a as j,b as Lt,d as _t,s as oe,e as Xe,B as At,L as Ye,U as et,f as Et}from"./index-DYVKctu5.js";import{M as Rt,T as tt,X as ge,D as Ot,U as Ft}from"./MessageModal-DuKtzDp4.js";import{C as Le,a as Vt,F as Bt,b as st,P as Ut}from"./CharacterDetailModal-D_qhSIkU.js";import{C as Ie}from"./circle-alert-DuJTuH7P.js";import{C as Ht,H as Pt}from"./RelationshipResultView-DtqYq4Uv.js";import{A as qt}from"./arrow-right-BJhjcQdg.js";import{B as Wt,F as Kt}from"./share-2-S1OTWEp_.js";import{R as Jt,a as Gt,P as Zt,b as Qt,c as Xt,T as Yt,S as es}from"./RadarChart-CPrWotcp.js";import{S as ct,P as Te,U as at,a as ts}from"./CharacterNetworkMap-k2YLkd0I.js";import{Z as ss}from"./zap-D47zeW3z.js";import{C as _e}from"./palette-BtGilZ2e.js";import{S as as}from"./save-DCv1ZqEp.js";import"./circle-check-Co-gnoo8.js";import"./check-DMXkaoiI.js";/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],dt=S("arrow-down-wide-narrow",rs);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2",key:"57tc96"}]],ns=S("audio-waveform",ls);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],os=S("book",is);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ye=S("calendar",cs);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],xs=S("chart-line",ds);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ps=S("file-text",ms);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],xt=S("hash",us);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],rt=S("history",hs);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],gs=S("layout-panel-left",fs);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=[["path",{d:"M14 14a2 2 0 0 0 2-2V8h-2",key:"1r06pg"}],["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M8 14a2 2 0 0 0 2-2V8H8",key:"1jzu5j"}]],bs=S("message-square-quote",ys);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],js=S("message-square",vs);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ns=S("minus",ws);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lt=S("pen",ks);/**
 * @license lucide-react v0.559.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]],Ss=S("text-align-justify",Cs),zs=l.lazy(()=>It(()=>import("./CharacterDetailModal-D_qhSIkU.js").then(o=>o.c),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),q=o=>typeof o=="string"?o:o&&typeof o=="object"?o.bestMatch&&o.why?`${o.bestMatch}

${o.why}`:JSON.stringify(o,null,2).replace(/\\n/g,`
`):String(o||""),Me=({text:o,label:w,icon:b,colorClass:N="text-indigo-400"})=>{const[h,A]=l.useState(!1),u=o.split(`
`).length>3||o.length>150;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`text-[9px] md:text-[10px] font-black ${N} opacity-40 uppercase tracking-widest flex items-center gap-1.5`,style:{color:"var(--text-primary)"},children:[b," ",w]}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-[11px] md:text-[12px] leading-relaxed whitespace-pre-wrap font-medium transition-all duration-300 ${!h&&u?"line-clamp-3":""}`,style:{color:"var(--text-primary)"},children:o}),u&&e.jsx("button",{onClick:()=>A(!h),className:"mt-1 text-[9px] md:text-[10px] font-black text-indigo-400 hover:underline flex items-center gap-1",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Le,{size:10})," 접기"]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{size:10})," ",w," 더 보기"]})})]})]})},Ds=({logs:o,knownProfiles:w,onUpdateProfile:b,onNavigateToAnalysis:N,focusTarget:h,currentCategoryId:A})=>{var J,se,ae,re,U,G,L,Z,le;const[u,xe]=l.useState(""),[$,E]=l.useState(null),[F,ve]=l.useState("latest"),p=l.useRef({}),[me,R]=l.useState(!0),ee=l.useRef(0),T=l.useCallback(s=>{const x=s.currentTarget.scrollTop;Math.abs(x-ee.current)<=40||(x>ee.current&&x>80?R(!1):R(!0),ee.current=x)},[]),V=l.useMemo(()=>{try{const s=new Set;return o.forEach(x=>{var c,n;(n=(c=x.analysis)==null?void 0:c.characterReactions)==null||n.forEach(m=>{if(m!=null&&m.name){const v=w.find(_=>String(_.name)===String(m.name)||_.aliases&&_.aliases.some(d=>String(d).toLowerCase()===String(m.name).toLowerCase()));s.add(v?v.name:String(m.name))}})}),Array.from(s).sort()}catch{return[]}},[o,w]);l.useEffect(()=>{if(h!=null&&h.charName){const s=q(h.charName),x=w.find(n=>String(n.name)===s||n.aliases&&n.aliases.some(m=>String(m).toLowerCase()===s.toLowerCase())),c=x?x.name:s;xe(c)}},[V,h,w]),l.useEffect(()=>{if(h&&u){const s=p.current[h.logId];if(s){const x=setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"center"}),s.classList.add("ring-4","ring-indigo-500/50"),setTimeout(()=>s.classList.remove("ring-4","ring-indigo-500/50"),3e3)},500);return()=>clearTimeout(x)}}},[u,h]);const M=l.useMemo(()=>{if(!u)return[];const s=w.find(c=>c.name===u),x=s?[s.name,...s.aliases||[]]:[u];return o.filter(c=>{var n,m;return(m=(n=c.analysis)==null?void 0:n.characterReactions)==null?void 0:m.some(v=>x.includes(String(v.name)))}).map(c=>{var m,v;const n=(v=(m=c.analysis)==null?void 0:m.characterReactions)==null?void 0:v.find(_=>x.includes(String(_.name)));return{...c,reaction:n,emotions:n==null?void 0:n.emotions,emotionText:(n==null?void 0:n.emotion)||"-",innerThought:q(n==null?void 0:n.innerThought)||"-",stress:(n==null?void 0:n.stressLevel)||0}}).sort((c,n)=>{if(F==="latest"){const m=new Date(`${c.date}T${c.time||"00:00"}`).getTime(),v=new Date(`${n.date}T${n.time||"00:00"}`).getTime();return v!==m?v-m:(n.timestamp||0)-(c.timestamp||0)}else return(n.timestamp||0)-(c.timestamp||0)})},[o,u,F,w]),te=l.useMemo(()=>{if(M.length===0)return[];const s=M.reduce((c,n)=>{var m,v,_,d,H;return c.joy+=((m=n.emotions)==null?void 0:m.joy)||0,c.anger+=((v=n.emotions)==null?void 0:v.anger)||0,c.sadness+=((_=n.emotions)==null?void 0:_.sadness)||0,c.fear+=((d=n.emotions)==null?void 0:d.fear)||0,c.trust+=((H=n.emotions)==null?void 0:H.trust)||0,c},{joy:0,anger:0,sadness:0,fear:0,trust:0}),x=M.length;return[{subject:"기쁨",A:s.joy/x},{subject:"분노",A:s.anger/x},{subject:"슬픔",A:s.sadness/x},{subject:"두려움",A:s.fear/x},{subject:"신뢰",A:s.trust/x}]},[M]),B=l.useMemo(()=>{if(!te.length)return"var(--accent-primary)";const x=[...te].sort((c,n)=>n.A-c.A)[0];return x.subject==="기쁨"?"#fbbf24":x.subject==="분노"?"#f43f5e":x.subject==="슬픔"?"#60a5fa":x.subject==="두려움"?"#a855f7":x.subject==="신뢰"?"#10b981":"var(--accent-primary)"},[te]),f=w.find(s=>s.name===u),I=s=>s==="joy"?"bg-amber-400":s==="anger"?"bg-rose-500":s==="sadness"?"bg-blue-400":s==="fear"?"bg-purple-500":s==="trust"?"bg-emerald-500":"bg-indigo-400",W=s=>{var x;return s&&((x=Object.entries(s).sort(([,c],[,n])=>Number(n)-Number(c))[0])==null?void 0:x[0])||"trust"},K=l.useMemo(()=>{try{return getComputedStyle(document.documentElement).getPropertyValue("--glass-bg").trim().includes("rgba(0, 0, 0")?"#ffffff":"var(--text-primary)"}catch{return"#ffffff"}},[]);return V.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 opacity-30 italic font-black gap-4",style:{color:"var(--text-primary)"},children:[e.jsx(Ie,{size:64}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"textxl",children:"아직 분석된 데이터가 없습니다."}),e.jsx("p",{className:"text-sm mt-2 font-bold",children:"서사를 등록하고 분석을 시작해 보세요."})]})]}):e.jsxs("div",{className:"space-y-0 animate-fade-in w-full h-full flex flex-col min-h-0",children:[e.jsx("div",{className:`p-3 md:p-4 glass-panel rounded-xl border border-white/10 shrink-0 mb-4 transition-all duration-300 overflow-hidden ${me?"max-h-24 opacity-100":"max-h-0 opacity-0 py-0 mb-0 border-0"}`,children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-3",children:[e.jsx("span",{className:"text-[9px] md:text-[10px] font-black opacity-40 uppercase tracking-widest whitespace-nowrap",style:{color:"var(--text-primary)"},children:"캐릭터 선택"}),e.jsxs("select",{value:u,onChange:s=>xe(s.target.value),className:"bg-white text-black border border-white/10 rounded-lg px-2 md:px-4 py-1.5 md:py-2 text-[11px] font-bold outline-none focus:ring-1 focus:ring-indigo-500 w-auto min-w-[120px]",children:[" ",e.jsx("option",{value:"",disabled:!0,children:"캐릭터 선택"},""),V.map(s=>e.jsx("option",{value:s,children:s},s))]})]})}),u?e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-1 space-y-6 md:space-y-10 pb-20",onScroll:T,children:[e.jsxs("div",{className:"glass-panel p-5 md:p-8 rounded-2xl md:rounded-3xl border border-white/10 flex flex-col md:flex-row items-center gap-5 md:gap-8 relative shrink-0 overflow-hidden",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full overflow-hidden border-2 border-white/10 flex items-center justify-center relative bg-black/5 cursor-pointer z-10 shrink-0",onClick:()=>f&&E(f),children:f!=null&&f.thumbnailUrl||f!=null&&f.imageUrl?e.jsx("img",{src:f.thumbnailUrl||f.imageUrl,alt:u,className:"w-full h-full object-cover"}):e.jsx(Ht,{size:40,className:"opacity-50 text-white"})}),e.jsxs("div",{className:"text-center md:text-left flex-1 min-w-0 z-10 flex flex-col md:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"space-y-2 md:space-y-3 w-full",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-black cursor-pointer hover:text-indigo-400 transition-colors inline-flex items-center gap-2 max-w-full",style:{color:"var(--text-primary)"},onClick:()=>{f?E(f):N==null||N(u)},children:[q(u)," ",e.jsx(qt,{size:16,className:"opacity-30 shrink-0"})]}),f?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex wrap items-center gap-1.5 justify-center md:justify-start",children:[e.jsxs("span",{className:"px-1.5 py-0.5 bg-indigo-500/10 border border-indigo-500/20 rounded-md text-[8px] md:text-[9px] font-black text-indigo-400 flex items-center gap-1",children:[e.jsx(Wt,{size:10})," ",e.jsx("span",{className:"hidden sm:inline",children:"MBTI"})," ",(se=(J=f.analysisData)==null?void 0:J.mbti)==null?void 0:se.type]}),e.jsxs("span",{className:"px-1.5 py-0.5 bg-purple-500/10 border border-purple-500/20 rounded-md text-[8px] md:text-[9px] font-black text-purple-400 flex items-center gap-1",children:[e.jsx(Kt,{size:10})," ",e.jsx("span",{className:"hidden sm:inline",children:"ENN"})," ",(re=(ae=f.analysisData)==null?void 0:ae.enneagram)==null?void 0:re.type]}),e.jsxs("span",{className:"px-1.5 py-0.5 bg-pink-500/10 border border-pink-500/20 rounded-md text-[8px] md:text-[9px] font-black text-pink-400 flex items-center gap-1",children:[e.jsx(be,{size:10})," ",e.jsx("span",{className:"hidden sm:inline",children:"원형"})," ",Mt[(G=(U=f.analysisData)==null?void 0:U.archetype)==null?void 0:G.name]||((Z=(L=f.analysisData)==null?void 0:L.archetype)==null?void 0:Z.name)]})]}),e.jsxs("p",{className:"text-[11px] md:text-sm opacity-70 font-bold italic line-clamp-2 md:line-clamp-none",style:{color:"var(--text-primary)"},children:['"',q((le=f.analysisData)==null?void 0:le.oneLineSummary)||"",'"']})]}):e.jsxs("div",{className:"p-3 md:p-5 rounded-xl md:rounded-[2rem] bg-amber-500/10 border border-amber-500/30 flex items-center gap-3 md:gap-5 shadow-sm",children:[e.jsx(Ie,{size:16,className:"text-amber-500 shrink-0 animate-pulse"}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"text-[9px] font-black text-amber-500 uppercase tracking-widest",children:"미분석"}),e.jsx("p",{className:"text-[10px] font-bold",style:{color:"var(--text-primary)"},children:"프로필 분석이 필요합니다. 이미 등록된 캐릭터일 경우 카테고리를 지정하세요."})]}),e.jsx("button",{onClick:()=>N==null?void 0:N(u),className:"px-3 md:px-5 py-1.5 md:py-2 bg-amber-500 rounded-lg md:rounded-xl text-black font-black text-[9px] md:text-[10px] hover:bg-amber-400 transition-all shrink-0",children:"분석"})]})]}),e.jsx("div",{className:"w-24 h-24 md:w-28 md:h-28 opacity-90 shrink-0",children:e.jsx(Jt,{width:"100%",height:"100%",children:e.jsxs(Gt,{cx:"50%",cy:"50%",outerRadius:"60%",data:te,children:[e.jsx(Zt,{stroke:"rgba(255,255,255,0.1)"}),e.jsx(Qt,{dataKey:"subject",tick:{fill:"white",fontSize:8}}),e.jsx(Xt,{name:"값",dataKey:"A",stroke:B,fill:B,fillOpacity:.4})," ",e.jsx(Yt,{contentStyle:{backgroundColor:"rgba(0,0,0,0.8)",border:"none",color:"white",fontSize:8}})]})})})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3 shrink-0",children:[e.jsxs("h3",{className:"text-[10px] md:text-[11px] font-black flex items-center gap-2 uppercase tracking-[0.2em] text-indigo-400 pl-1",children:[e.jsx(ye,{size:13})," 서사 타임라인"]}),e.jsx("div",{className:"max-h-[220px] md:max-h-[300px] overflow-y-auto custom-scrollbar space-y-2 pr-1",children:M.map(s=>{var x,c;return e.jsxs("div",{onClick:()=>{const n=p.current[s.id];n==null||n.scrollIntoView({behavior:"smooth",block:"center"})},className:"glass-panel p-3 md:p-5 rounded-xl md:rounded-2xl border border-white/5 hover:border-indigo-500/40 hover:bg-white/5 transition-all cursor-pointer group flex flex-col gap-1.5 bg-black/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-[8px] md:text-[9px] font-black opacity-30",style:{color:"var(--text-primary)"},children:[s.date," ",s.time&&e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[8px] md:text-[9px] font-black text-indigo-400 opacity-60 uppercase",children:[e.jsx(ct,{size:9,fill:"currentColor"})," ",((x=s.analysis)==null?void 0:x.score)||0,"점"]}),e.jsxs("div",{className:"flex items-center gap-1 text-[8px] md:text-[9px] font-black text-rose-400 opacity-60 uppercase",children:[e.jsx(ss,{size:9})," ",s.stress,"%"]})]}),e.jsx(ot,{size:12,className:"opacity-0 group-hover:opacity-100 transition-all text-indigo-400 shrink-0"})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-0.5",children:((c=s.analysis)==null?void 0:c.keywords)&&s.analysis.keywords.map((n,m)=>e.jsxs("span",{className:"text-[8px] md:text-[9px] font-black text-indigo-400 bg-indigo-500/10 px-1 py-0.5 rounded border border-indigo-500/20",children:[e.jsx(xt,{size:7,className:"inline"}),q(n)]},m))})]},s.id)})})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-end pl-1",children:[e.jsxs("h3",{className:"text-[10px] md:text-[11px] font-black flex items-center gap-2 uppercase tracking-[0.1em] text-violet-400",children:[e.jsx(ns,{size:13})," 감정 로그"]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1.5 bg-black/5 rounded-xl border border-white/5 shadow-inner",children:[e.jsx(dt,{size:12,className:"opacity-40"}),e.jsxs("select",{value:F,onChange:s=>ve(s.target.value),className:"bg-transparent border-none p-0 text-[10px] font-black outline-none cursor-pointer",style:{color:K},children:[e.jsx("option",{value:"latest",className:"bg-slate-900",style:{backgroundColor:"var(--bg-from)",color:"var(--text-primary)"},children:"날짜순"}),e.jsx("option",{value:"oldest",className:"bg-slate-900",style:{backgroundColor:"var(--bg-from)",color:"var(--text-primary)"},children:"등록순"})]})]})]}),e.jsx("div",{className:"flex wrap justify-end gap-2 text-[8px] opacity-60 font-black uppercase tracking-widest pl-1 px-3 py-5",children:["joy","anger","sadness","fear","trust"].map(s=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-1 h-1 rounded-full ${I(s)}`}),s==="joy"?"기쁨":s==="anger"?"분노":s==="sadness"?"슬픔":s==="fear"?"두려움":"신뢰"]},s))})]}),e.jsx("div",{className:"grid gap-3 w-full",children:M.map(s=>{var c;const x=W(s.emotions);return e.jsxs("div",{ref:n=>{p.current[s.id]=n},className:"p-4 md:p-5 rounded-[1.5rem] md:rounded-[2.5rem] border-l-4 md:border-l-8 glass-panel shadow-xl flex flex-col gap-4 md:gap-6 bg-white/5 scroll-mt-10 md:scroll-mt-20",style:{borderLeftColor:"var(--accent-primary)"},children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-white/5 pb-2",children:[e.jsxs("span",{className:"text-[10px] font-black opacity-40",style:{color:"var(--text-primary)"},children:[s.date," ",s.time]}),e.jsxs("div",{className:"flex items-center gap-3 md:gap-6",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full border border-white/10 ${I(x)}`,title:`스트레스 : ${s.stress}%`,children:e.jsx("span",{className:"text-[11px] font-black text-white",children:s.emotionText})})}),e.jsx("div",{className:"flex gap-1",children:s.emotions&&Object.entries(s.emotions).map(([n,m])=>e.jsx("div",{className:"w-1.5 md:w-2.5 h-3 md:h-4 bg-slate-700/20 rounded-sm overflow-hidden relative border border-white/5",children:e.jsx("div",{className:`absolute bottom-0 w-full transition-all duration-700 ${I(n)}`,style:{height:`${Number(m)*10}%`}})},n))})]})]}),e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(bs,{className:"text-violet-500 shrink-0 mt-1",size:14}),e.jsxs("div",{className:"flex-1 space-y-2 overflow-hidden",children:[e.jsx(Me,{text:q(s.innerThought),label:"속마음",icon:e.jsx(Pt,{size:10}),colorClass:"text-violet-400"}),e.jsxs("div",{className:"p-4 md:p-6 rounded-2xl md:rounded-[2rem] bg-black/5 border border-white/5 space-y-3 md:space-y-4",children:[e.jsx(Me,{text:q((c=s.analysis)==null?void 0:c.summary),label:"분석 요약",icon:e.jsx(be,{size:10}),colorClass:"text-indigo-400"}),e.jsx("div",{className:"border-t border-white/5 pt-3",children:e.jsx(Me,{text:q(s.content),label:"서사 원문",icon:e.jsx(es,{size:10}),colorClass:"text-slate-400"})})]})]})]})]},s.id)})})]}):e.jsx("div",{className:"text-center py-24 opacity-30 italic font-bold text-white",children:"캐릭터를 선택해 주세요."}),$&&e.jsx(l.Suspense,{fallback:null,children:e.jsx(zs,{character:$,isOpen:!!$,onClose:()=>E(null),onSave:async s=>{await(b==null?void 0:b(s)),E(null)},onDelete:()=>E(null),onGoToAnalysis:N})})]})},nt=(o,w)=>{const b=String(o||"").replace(/[\[\]]/g,"").trim().toLowerCase();return w.find(N=>{var h;return String(N.name||"").trim().toLowerCase()===b||((h=N.aliases)==null?void 0:h.some(A=>String(A||"").trim().toLowerCase()===b))})},C=o=>typeof o=="string"||typeof o=="number"?String(o):o&&typeof o=="object"?o.bestMatch&&o.why?`${o.bestMatch}

${o.why}`:JSON.stringify(o).replace(/\\n/g,`
`):String(o||""),it=({text:o,label:w,icon:b,colorClass:N="text-indigo-400"})=>{const[h,A]=l.useState(!1),u=o.split(`
`).length>3||o.length>150;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:`text-[9px] font-black ${N} opacity-60 uppercase tracking-widest flex items-center gap-1.5`,children:[b," ",w]}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-[13px] leading-relaxed whitespace-pre-wrap transition-all duration-300 ${!h&&u?"line-clamp-3":""}`,style:{color:"var(--text-primary)"},children:o}),u&&e.jsx("button",{onClick:()=>A(!h),className:"mt-1 text-[10px] font-black text-[var(--accent-primary)] hover:underline flex items-center gap-1",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Le,{size:12})," 접기"]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{size:12})," ",w," 더 보기"]})})]})]})},Hs=({apiKey:o,provider:w,savedCharacters:b,onUpdateProfile:N,onNavigateToCharacter:h,timezoneOffset:A})=>{var Je,Ge,Ze,Qe;const[u,xe]=l.useState([]),[$,E]=l.useState([]),[F,ve]=l.useState([]),[p,me]=l.useState(()=>{try{return localStorage.getItem("hpersona_selected_cat")||"all"}catch{return"all"}}),[R,ee]=l.useState("history"),[T,V]=l.useState(null),[M,te]=l.useState(()=>{try{return localStorage.getItem("hpersona_log_sort_order")||"latest"}catch{return"latest"}}),[B,f]=l.useState(!1),[I,W]=l.useState(""),K=l.useCallback(()=>{const t=new Date,a=t.getTime()+t.getTimezoneOffset()*6e4,r=new Date(a+36e5*A);return{date:r.toISOString().split("T")[0],time:r.toTimeString().slice(0,5)}},[A]),[J,se]=l.useState(()=>K().date),[ae,re]=l.useState(()=>K().time),[U,G]=l.useState([]),[L,Z]=l.useState(null),[le,s]=l.useState(!1),[x,c]=l.useState(!1),[n,m]=l.useState(""),[v,_]=l.useState(()=>K().date),[d,H]=l.useState(window.innerWidth<1024),[je,mt]=l.useState(!1),[pt,Ae]=l.useState(null),[we,Ne]=l.useState(null),[ut,ke]=l.useState(!1),[Ee,Re]=l.useState(""),[ht,Ce]=l.useState(null),[Oe,Fe]=l.useState(""),[pe,ue]=l.useState(null),[Se,he]=l.useState(null),[ft,fe]=l.useState(null),[ne,Ve]=l.useState({isOpen:!1,type:"info",title:"",message:"",onConfirm:()=>{}}),Q=(t,a,r,i,g)=>{Ve({isOpen:!0,type:t,title:a,message:r,onConfirm:i,defaultValue:g})},P=()=>Ve(t=>({...t,isOpen:!1})),gt=l.useRef(null),ie=l.useRef(null),ze=l.useRef(null),[yt,Be]=l.useState(!0),De=l.useRef(0),$e=l.useCallback(()=>{if(!ie.current)return;const t=ie.current.scrollTop;Math.abs(t-De.current)<=50||(t>De.current&&t>100?Be(!1):Be(!0),De.current=t)},[]);l.useEffect(()=>{const t=ie.current;if(t)return t.addEventListener("scroll",$e),()=>t.removeEventListener("scroll",$e)},[$e]);const z=l.useCallback(async()=>{try{const[t,a,r]=await Promise.all([j.loadLogs(),j.loadNarrativeCategories(),j.loadDDays()]);xe(t||[]),E(a||[]),ve(r||[])}catch(t){console.error("데이터 로드 오류:",t)}},[]);l.useEffect(()=>{z()},[z]),l.useEffect(()=>{if(le&&!L){const{date:t,time:a}=K();se(t),re(a)}},[le,L,K]),l.useEffect(()=>{try{localStorage.setItem("hpersona_selected_cat",p)}catch{}L&&(Z(null),W(""),G([]),s(!1))},[p]),l.useEffect(()=>{try{localStorage.setItem("hpersona_log_sort_order",M)}catch{}},[M]);const ce=l.useMemo(()=>[...p==="all"?u:u.filter(a=>a.categoryId===p)].sort((a,r)=>{if(M==="latest"){const i=new Date(`${a.date}T${a.time||"00:00"}`).getTime(),g=new Date(`${r.date}T${r.time||"00:00"}`).getTime();return g!==i?g-i:(r.timestamp||0)-(a.timestamp||0)}else return(r.timestamp||0)-(a.timestamp||0)}),[u,p,M]),bt=l.useMemo(()=>[...ce].sort((t,a)=>{const r=new Date(`${t.date}T${t.time||"00:00"}`).getTime(),i=new Date(`${a.date}T${a.time||"00:00"}`).getTime();return r!==i?r-i:(t.timestamp||0)-(a.timestamp||0)}),[ce]),Ue=l.useMemo(()=>$.filter(t=>t.id!=="default"),[$]),He=l.useMemo(()=>p==="all"?b:b.filter(t=>t.category===p||!t.category&&p==="default"),[b,p]),Pe=async t=>{const a=oe(I);if(!(!a||a.length>2e3)&&p!=="all"){f(!0);try{const r=L?u.find(y=>y.id===L):null;let i=(r==null?void 0:r.analysis)||null;if(t){const y=b.filter(D=>U.includes(D.id)),O=y.map(D=>D.name),X=new Date(`${J}T${ae}`).getTime(),Y=u.filter(D=>D.categoryId===p).filter(D=>new Date(`${D.date}T${D.time||"00:00"}`).getTime()<X).filter(D=>{var de;return(de=D.characters)==null?void 0:de.some(Tt=>O.includes(Tt.name))}).sort((D,de)=>new Date(`${D.date}T${D.time||"00:00"}`).getTime()-new Date(`${de.date}T${de.time||"00:00"}`).getTime()).slice(-15);i=await Et(a,J,w,o,y,Y)}const g=((i==null?void 0:i.characterReactions)||[]).map(y=>{var X,Y;const O=nt(y.name,b);return O?{name:O.name,mbti:((Y=(X=O.analysisData)==null?void 0:X.mbti)==null?void 0:Y.type)||"Unknown"}:{name:C(y.name).replace(/[\[\]]/g,""),mbti:"Unknown"}}).filter(y=>y.name!=="Unknown"),k={id:L||crypto.randomUUID(),categoryId:p,date:J,time:ae,content:a,analysis:i,characters:g,timestamp:r?r.timestamp:Date.now()};await j.saveLog(k),await z(),W(""),G([]),Z(null),s(!1)}catch(r){Q("error","처리 실패",r.message,P)}finally{f(!1)}}},qe=async()=>{const t=oe(Ee);if(!t){ke(!1);return}const a=[...$,{id:crypto.randomUUID(),name:t}];await j.saveNarrativeCategories(a),E(a),Re(""),ke(!1)},We=async t=>{const a=oe(Oe);if(!a){Ce(null);return}await j.renameNarrativeCategory(t,a),await z(),Ce(null)},vt=async(t,a)=>{const r=u.find(i=>i.id===t);r&&(await j.saveLog({...r,categoryId:a}),await z())},Ke=(t,a)=>{V(null),Ae({charName:C(t).replace(/[\[\]]/g,""),logId:a}),ee("analysis")},jt=t=>{Z(t.id),W(C(t.content)),se(t.date),re(t.time||"12:00"),G(b.filter(a=>{var r;return(r=t.characters)==null?void 0:r.some(i=>i.name.trim().toLowerCase()===a.name.trim().toLowerCase())}).map(a=>a.id)),s(!0),ie.current&&ie.current.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{var a;return(a=ze.current)==null?void 0:a.focus()},100)},wt=t=>{Q("confirm","기록 삭제","정말 삭제하시겠습니까?",async()=>{await j.deleteLog(t),await z(),P()})},Nt=async t=>{var i;const a=(i=t.target.files)==null?void 0:i[0];if(!a)return;const r=new FileReader;r.onload=async g=>{var k;try{const y=JSON.parse((k=g.target)==null?void 0:k.result);await j.restoreNarrativeBackup(y)?(await z(),Q("success","서사 복원 완료","서사 기록이 성공적으로 로드되었습니다.",P)):Q("error","복원 실패","데이터 형식이 서사 백업 파일이 아닙니다.",P)}catch{Q("error","로드 오류","파일을 읽는 중 오류가 발생했습니다.",P)}},r.readAsText(a),t.target.value=""},kt=()=>{const t=new Date,a=t.getTime()+t.getTimezoneOffset()*6e4;return new Date(a+36e5*A)},Ct=l.useMemo(()=>{try{return getComputedStyle(document.documentElement).getPropertyValue("--glass-bg").trim().includes("rgba(0, 0, 0")?"#ffffff":"var(--text-primary)"}catch{return"#ffffff"}},[]),St=(t,a)=>{he(a),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",a.toString())},zt=(t,a)=>{t.preventDefault(),fe(a)},Dt=async(t,a)=>{if(t.preventDefault(),Se===null||Se===a){he(null),fe(null);return}const r=[...Ue],[i]=r.splice(Se,1);r.splice(a,0,i);const k=[$.find(y=>y.id==="default")||{id:"default",name:"기본"},...r];E(k),await j.saveNarrativeCategories(k),he(null),fe(null)},$t=async()=>{const t=oe(n);if(t){const a=[...F,{id:crypto.randomUUID(),title:t,targetDate:v}];await j.saveDDays(a),await z(),m(""),c(!1)}};return e.jsxs("div",{className:"flex h-full animate-fade-in overflow-hidden",style:{minWidth:"300px"},children:[e.jsx(Lt,{isVisible:B,message:L?"서사를 수정하고 분석 중입니다...":"AI가 서사를 분석하고 있습니다..."}),e.jsx(Rt,{isOpen:ne.isOpen,type:ne.type,title:ne.title,message:ne.message,defaultValue:ne.defaultValue,onConfirm:ne.onConfirm,onCancel:P}),we&&e.jsx(Vt,{character:we,isOpen:!!we,onClose:()=>Ne(null),onSave:t=>{N(t),Ne(null)},onDelete:t=>{j.deleteProfile(t),Ne(null)}}),pe&&e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",style:{minWidth:"200px"},onClick:()=>ue(null),children:e.jsxs("div",{className:"w-full max-w-xs glass-panel p-6 rounded-[2rem] border shadow-2xl animate-bounce-in",style:{borderColor:"var(--glass-border)",backgroundColor:"var(--glass-bg)"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-500/10 flex items-center justify-center mx-auto mb-3 text-indigo-400",children:e.jsx(_t,{size:24})}),e.jsx("h3",{className:"text-sm font-black text-white",children:"카테고리 관리"}),e.jsxs("p",{className:"text-[10px] opacity-60 font-bold mt-1",children:["'",pe.name,"' 설정을 변경합니다."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{const t=pe;ue(null),Q("prompt","카테고리 수정","새 이름을 입력하세요.",async a=>{a&&(await j.renameNarrativeCategory(t.id,oe(a)),await z()),P()},t.name)},className:"w-full py-3 rounded-xl bg-white/5 border border-white/10 text-xs font-black text-white hover:bg-white/10 transition-all flex items-center justify-center gap-2",children:[e.jsx(lt,{size:10,className:"text-indigo-400"})," 이름 수정"]}),e.jsxs("button",{onClick:()=>{const t=pe;ue(null),Q("confirm","카테고리 삭제","정말 삭제하시겠습니까?",async()=>{if(t.id!=="default"){const a=$.filter(r=>r.id!==t.id);await j.saveNarrativeCategories(a),await z()}P()})},className:"w-full py-3 rounded-xl bg-rose-500/10 border border-rose-500/20 text-xs font-black text-rose-400 hover:bg-rose-500/20 transition-all flex items-center justify-center gap-2",children:[e.jsx(tt,{size:10})," 삭제"]}),e.jsx("button",{onClick:()=>ue(null),className:"w-full py-3 text-[10px] font-black opacity-40 hover:opacity-100 transition-all",children:"닫기"})]})]})}),d&&x&&e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:()=>c(!1),children:e.jsxs("div",{className:"w-full max-w-xs glass-panel p-6 rounded-[2rem] border shadow-2xl animate-bounce-in",style:{borderColor:"var(--glass-border)",backgroundColor:"var(--glass-bg)"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/10 flex items-center justify-center mx-auto mb-3 text-amber-500",children:e.jsx(ye,{size:24})}),e.jsx("h3",{className:"text-sm font-black text-white",children:"기념일 등록"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-black opacity-70 uppercase ml-1",children:"날짜"}),e.jsx("input",{type:"date",value:v,onChange:t=>_(t.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2.5 text-xs text-white outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-black opacity-70 uppercase ml-1",children:"사건명"}),e.jsx("input",{type:"text",value:n,onChange:t=>m(t.target.value),placeholder:"예: 첫 만남...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-2.5 text-xs text-white outline-none"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 py-3 text-xs font-black opacity-40 text-white hover:opacity-100 transition-all",children:"취소"}),e.jsx("button",{onClick:$t,className:"flex-[2] py-3 bg-[var(--accent-primary)] rounded-xl text-xs font-black text-white hover:bg-indigo-500 shadow-lg shadow-[var(--accent-primary)]",children:"등록"})]})]})]})}),d&&e.jsx("button",{onClick:()=>H(!1),className:"md:hidden fixed bottom-4 left-1 z-[60] p-3 rounded-full bg-[var(--accent-primary)] text-white shadow-2xl border border-l-[var(--accent-primary)] animate-bounce-in",children:e.jsx(gs,{size:15})}),e.jsxs("aside",{className:`glass-panel border-r flex flex-col h-full shadow-2xl backdrop-blur-xl z-20 shrink-0 transition-all duration-300 ease-in-out ${d?"w-0 md:w-20 opacity-0 md:opacity-100 overflow-hidden":"w-64 md:w-72 opacity-100"}`,style:{borderColor:"var(--glass-border)"},children:[e.jsxs("div",{className:`p-6 border-b shrink-0 flex items-center ${d?"justify-center":"justify-between"}`,style:{borderColor:"var(--glass-border)"},children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(Bt,{size:18,className:"shrink-0",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"}}),!d&&e.jsx("h2",{className:"text-sm font-black uppercase tracking-widest truncate",style:{color:"var(--text-primary)"},children:"서사 아카이브"})]}),!d&&e.jsx("button",{onClick:()=>H(!0),className:"md:hidden ml-auto p-2 text-white/50",children:e.jsx(Xe,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-6 flex flex-col",children:[e.jsxs("div",{className:"space-y-1 p-2",children:[e.jsxs("div",{className:`flex items-center mb-2 ${d?"justify-center":"justify-between px-2"}`,children:[!d&&e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-40",style:{color:"var(--text-primary)"},children:"카테고리"}),!d&&e.jsx("button",{onClick:()=>mt(!je),className:"p-1 hover:bg-white/5 rounded-md transition-colors opacity-40 hover:opacity-100",style:{color:"var(--text-primary)"},children:je?e.jsx(_e,{size:14}):e.jsx(Le,{size:14})})]}),!je&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{me("all"),window.innerWidth<1024&&H(!0)},className:`w-full text-left px-2 py-3 rounded-xl transition-all text-xs font-black flex items-center gap-3 ${d?"justify-center":"justify-start md:px-4"} ${p==="all"?"shadow-lg":"opacity-60 hover:opacity-100 hover:bg-white/5"}`,style:{backgroundColor:p==="all"?"var(--accent-primary)":"transparent",color:p==="all"?"var(--accent-text)":"var(--text-primary)"},children:[e.jsx(Ss,{size:14,className:"shrink-0"})," ",!d&&e.jsx("span",{className:"truncate",children:"전체 기록"})]}),e.jsxs("div",{className:`${d?"":"pl-2 border-l border-white/10"} space-y-1 mt-1`,children:[Ue.map((t,a)=>e.jsxs("div",{className:`group relative transition-all ${ft===a?"border-t-2 border-indigo-500/50 pt-2":""}`,draggable:!d,onDragStart:r=>St(r,a),onDragOver:r=>zt(r,a),onDrop:r=>Dt(r,a),onDragEnd:()=>{he(null),fe(null)},children:[e.jsx("div",{className:`flex items-center rounded-xl transition-all ${p===t.id?"bg-white/5 ring-1 ring-white/10":"hover:bg-white/5"}`,children:ht===t.id&&!d?e.jsx("div",{className:"flex-1 p-1",children:e.jsx("input",{autoFocus:!0,value:Oe,onChange:r=>Fe(r.target.value),onBlur:()=>We(t.id),onKeyDown:r=>r.key==="Enter"&&We(t.id),className:"w-full bg-black/40 border border-indigo-500/50 rounded-lg px-2 py-1 text-[11px] text-white outline-none"})}):e.jsxs("button",{onClick:()=>{me(t.id),window.innerWidth<1024&&H(!0)},className:`flex-1 text-left py-2.5 transition-all text-[11px] font-bold flex items-center gap-3 ${d?"justify-center":"justify-start px-2 md:px-4"} ${p===t.id?"":"opacity-50 hover:opacity-100"}`,style:{color:"var(--text-primary)"},children:[e.jsx(Ns,{size:12,className:`shrink-0 ${p===t.id?"text-indigo-500":"opacity-40"}`}),!d&&e.jsx("span",{className:"truncate pr-1",children:t.name})]})}),!d&&e.jsxs("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-900/80 rounded-lg p-1",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),Ce(t.id),Fe(t.name)},className:"p-1 text-white/30 hover:text-indigo-400",children:e.jsx(lt,{size:12})}),e.jsx("button",{onClick:async r=>{if(r.stopPropagation(),t.id!=="default"){const i=$.filter(g=>g.id!==t.id);await j.saveNarrativeCategories(i),await z()}},className:"p-1 text-white/30 hover:text-rose-400",children:e.jsx(ge,{size:12})})]})]},t.id)),!d&&e.jsx(e.Fragment,{children:ut?e.jsx("div",{className:"flex items-center gap-1 px-1 py-1",children:e.jsx("input",{autoFocus:!0,value:Ee,onChange:t=>Re(t.target.value),onBlur:qe,onKeyDown:t=>t.key==="Enter"&&qe(),placeholder:"이름...",className:"flex-1 bg-black/40 border border-white/10 rounded-lg px-2 py-1.5 text-[10px] text-white outline-none w-full"})}):e.jsxs("button",{onClick:()=>ke(!0),className:"w-full text-left px-2 md:px-4 py-2 rounded-xl opacity-30 hover:opacity-100 hover:bg-white/5 transition-all text-[11px] font-bold flex items-center justify-start gap-3",style:{color:"var(--text-primary)"},children:[e.jsx(Te,{size:12,className:"shrink-0"})," ",e.jsx("span",{className:"truncate",children:"추가"})]})})]})]})]}),e.jsx("div",{className:"flex-1"}),!d&&e.jsxs("div",{className:"space-y-3 pb-0 border-t border-white/5 pt-4 px-2 md:px-4",children:[e.jsxs("div",{className:"flex items-center opacity-50 justify-between px-2",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest truncate",style:{color:"var(--text-primary)"},children:"기념일 / 디데이"}),e.jsx("button",{onClick:()=>c(!x),className:"hover:text-amber-400 transition-colors shrink-0",style:{color:"var(--text-primary)"},children:e.jsx(Te,{size:14})})]}),x&&e.jsxs("div",{className:"p-2 md:p-3 rounded-2xl bg-indigo-500/5 border border-indigo-500/20 space-y-2",children:[e.jsx("input",{type:"date",value:v,onChange:t=>_(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg px-2 py-1 text-[10px] text-white outline-none"}),e.jsx("input",{type:"text",value:n,onChange:t=>m(t.target.value),placeholder:"사건명...",className:"w-full bg-black/20 border border-white/10 rounded-lg px-2 py-1 text-[10px] text-white outline-none"}),e.jsxs("div",{className:"flex gap-1 pt-1",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 py-1 text-[9px] font-black opacity-50 text-white",children:"취소"}),e.jsx("button",{onClick:async()=>{const t=oe(n);if(t){const a=[...F,{id:crypto.randomUUID(),title:t,targetDate:v}];await j.saveDDays(a),await z(),m(""),c(!1)}},className:"flex-1 py-1 bg-indigo-600 rounded-lg text-[9px] font-black text-white",children:"등록"})]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar",children:F.map(t=>{const a=kt(),r=Math.ceil((new Date(t.targetDate).getTime()-a.getTime())/(1e3*60*60*24));return e.jsxs("div",{className:"p-2 rounded-xl bg-black/10 border border-white/5 group relative transition-all hover:bg-black/20 flex flex-col items-start md:p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 mb-1.5 w-full",children:[e.jsxs("div",{className:"text-[8px] md:text-[9px] font-black opacity-40 flex items-center gap-1 overflow-hidden",style:{color:"var(--text-primary)"},children:[e.jsx(st,{size:10,className:"shrink-0"})," ",e.jsx("span",{className:"truncate",children:t.targetDate})]}),e.jsx("div",{className:`text-[9px] md:text-[10px] font-black shrink-0 ${r<0?"text-rose-500":r===0?"text-indigo-400":"text-amber-500"}`,children:r===0?"D-Day":r<0?`+${Math.abs(r)}`:`-${r}`})]}),e.jsx("div",{className:"text-[10px] md:text-[11px] font-bold leading-snug break-words pr-4 w-full",style:{color:"var(--text-primary)"},children:t.title}),e.jsx("button",{onClick:async i=>{i.stopPropagation();const g=F.filter(k=>k.id!==t.id);await j.saveDDays(g),await z()},className:"absolute top-1 right-1 p-1 opacity-0 group-hover:opacity-40 hover:opacity-100 hover:text-rose-500 transition-all",children:e.jsx(ge,{size:10})})]},t.id)})})]}),e.jsxs("div",{className:`p-1 border-t shrink-0 flex flex-row gap-2 ${d?"items-center":"p-1"}`,style:{borderColor:"var(--glass-border)"},children:[e.jsxs("button",{onClick:()=>j.createNarrativeBackup(),className:"flex items-center gap-0 py-2 rounded-xl bg-indigo-500/5 hover:bg-indigo-500/10 transition-colors text-[9px] font-black opacity-60 hover:opacity-100",style:{color:"var(--text-primary)",width:d?"auto":"100%",justifyContent:d?"center":"start",paddingLeft:d?"0.5rem":"1rem",paddingRight:d?"0.5rem":"1rem"},children:[e.jsx(Ot,{size:d?10:14,className:"shrink-0"})," ",!d&&e.jsx("span",{className:"truncate",children:"서사 백업"})]}),e.jsxs("label",{className:"flex items-center gap-0 py-2 rounded-xl bg-indigo-500/5 hover:bg-indigo-500/10 transition-colors text-[9px] font-black opacity-60 hover:opacity-100 cursor-pointer",style:{color:"var(--text-primary)",width:d?"auto":"100%",justifyContent:d?"center":"start",paddingLeft:d?"0.5rem":"1rem",paddingRight:d?"0.5rem":"1rem"},children:[e.jsx(Ft,{size:d?10:14,className:"shrink-0"})," ",!d&&e.jsx("span",{className:"truncate",children:"서사 복원"}),e.jsx("input",{type:"file",className:"hidden",onChange:Nt,accept:".json"})]})]})]}),e.jsx("div",{className:"p-4 border-t shrink-0 flex justify-center",style:{borderColor:"var(--glass-border)"},children:e.jsx("button",{onClick:()=>H(!d),className:"p-3 text-indigo-500 hover:scale-110 transition-transform",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"},children:d?e.jsx(ot,{size:24}):e.jsx(Xe,{size:24})})})]}),e.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:[e.jsxs("header",{className:`sticky top-0 z-40 px-4 md:px-8 flex flex-row justify-between items-center gap-4 shrink-0 transition-all duration-500 ease-in-out overflow-hidden ${yt?"py-3 md:py-6 border-b opacity-100":"h-0 py-0 border-b-0 opacity-0"}`,style:{borderColor:"var(--glass-border)",backgroundColor:"var(--glass-bg)"},children:[e.jsx("div",{className:"flex items-center gap-4 overflow-hidden",children:e.jsxs("h1",{className:"text-sm md:text-lg font-black flex items-center gap-2 md:gap-3 truncate",style:{color:"var(--text-primary)"},children:[e.jsx(At,{size:18,className:"text-indigo-500 shrink-0",style:{color:"var(--accent-primary)"}}),e.jsx("span",{className:"hidden md:inline",children:p==="all"?"전체 기록":(Je=$.find(t=>t.id===p))==null?void 0:Je.name})]})}),e.jsx("div",{className:"flex glass-panel p-1 rounded-xl border shadow-inner overflow-x-auto no-scrollbar max-w-full",style:{borderColor:"var(--glass-border)",backgroundColor:"rgba(0,0,0,0.1)"},children:[{id:"history",label:"서사 분석",icon:e.jsx(rt,{size:14})},{id:"analysis",label:"캐릭터별 분석",icon:e.jsx(at,{size:14})},{id:"trends",label:"타임라인",icon:e.jsx(xs,{size:14})}].map(t=>e.jsxs("button",{onClick:()=>{ee(t.id),Ae(null)},className:`flex items-center gap-2 px-3 md:px-5 py-2 rounded-lg text-[9px] md:text-[10px] font-black transition-all whitespace-nowrap ${R===t.id?"shadow-md scale-[1.02]":"opacity-40 hover:opacity-100 hover:bg-white/5"}`,style:{backgroundColor:R===t.id?"var(--accent-primary)":"transparent",color:R===t.id?"var(--accent-text)":"var(--text-primary)"},children:[t.icon," ",e.jsx("span",{className:"hidden md:inline",children:t.label})]},t.id))})]}),e.jsxs("div",{ref:ie,className:"flex-1 overflow-y-auto p-4 md:p-8 custom-scrollbar",children:[R==="history"&&e.jsxs("div",{className:"flex flex-col gap-6 md:gap-10 w-full max-w-5xl mx-auto h-full",children:[p!=="all"&&e.jsx("div",{className:"w-full",children:le?e.jsxs("div",{className:"glass-panel p-6 md:p-8 rounded-[2rem] md:rounded-[2.5rem] border bg-transparent shadow-xl animate-fade-in-up",style:{borderColor:"var(--glass-border)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-white/5 pb-4",children:[e.jsxs("h3",{className:"text-sm font-black text-indigo-400 flex items-center gap-2 uppercase tracking-widest",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"},children:[e.jsx(os,{size:16})," 서사 작성"]}),e.jsx("button",{onClick:()=>{s(!1),Z(null),W("")},className:"p-2 hover:bg-white/5 rounded-full transition-colors opacity-40 hover:opacity-100",children:e.jsx(ge,{size:20})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"w-full md:w-56 space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black opacity-30 uppercase ml-1",style:{color:"var(--text-primary)"},children:"날짜 및 시간"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"relative group overflow-hidden rounded-xl border border-white/10 bg-black/20 focus-within:ring-2 focus-within:ring-indigo-500/50 transition-all",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"},children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-indigo-400 opacity-60 pointer-events-none",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"},children:e.jsx(ye,{size:14})}),e.jsx("input",{type:"date",value:J,onChange:t=>se(t.target.value),className:"w-full bg-transparent pl-9 pr-4 py-2.5 text-[11px] font-bold outline-none cursor-pointer",style:{color:"var(--text-primary)"}})]}),e.jsxs("div",{className:"relative group overflow-hidden rounded-xl border border-white/10 bg-black/20 focus-within:ring-2 focus-within:ring-indigo-500/50 transition-all",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-indigo-400 opacity-60 pointer-events-none",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"},children:e.jsx(st,{size:14})}),e.jsx("input",{type:"time",value:ae,onChange:t=>re(t.target.value),className:"w-full bg-transparent pl-9 pr-4 py-2.5 text-[11px] font-bold outline-none cursor-pointer",style:{color:"var(--text-primary)"}})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black opacity-30 uppercase ml-1",style:{color:"var(--text-primary)"},children:"등장인물"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-32 overflow-y-auto custom-scrollbar p-1.5 bg-black/10 rounded-xl border border-white/5",children:He.map(t=>e.jsx("button",{onClick:()=>G(a=>a.includes(t.id)?a.filter(r=>r!==t.id):[...a,t.id]),className:`px-2 py-1 rounded-lg text-[9px] font-black transition-all border ${U.includes(t.id)?"shadow-md scale-[1.02]":"opacity-40 hover:bg-black/5"}`,style:{backgroundColor:U.includes(t.id)?"var(--accent-primary)":"transparent",borderColor:U.includes(t.id)?"transparent":"var(--glass-border)",color:U.includes(t.id)?"var(--accent-text)":"var(--text-primary)"},children:t.name},t.id))})]})]}),e.jsxs("div",{className:"flex-1 w-full space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-[9px] font-black opacity-30 uppercase",style:{color:"var(--text-primary)"},children:"내용 (최대 2000자)"}),e.jsxs("span",{className:`text-[9px] font-black ${I.length>2e3?"text-rose-500":"opacity-30"}`,children:[I.length," / 2000"]})]}),e.jsx("textarea",{ref:ze,value:I,onChange:t=>W(t.target.value),placeholder:"어떤 일이 일어났나요? 혹은 어떤 대화가 오갔나요?...",className:"w-full h-40 bg-transparent border rounded-2xl p-5 text-sm outline-none resize-none leading-relaxed focus:ring-1 focus:ring-[var(--accent-primary)] placeholder:opacity-30 custom-scrollbar shadow-inner",style:{color:"var(--text-primary)"}})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[e.jsxs("button",{onClick:()=>Pe(!1),disabled:B||!I.trim()||I.length>2e3,className:"flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-black rounded-xl flex items-center justify-center gap-2 border border-white/10 transition-all text-xs cursor-pointer",style:{color:"var(--accent-primary)"},children:[B?e.jsx(Ye,{size:14,className:"animate-spin"}):e.jsx(as,{size:14})," ",L?"수정":"기록 저장"]}),e.jsxs("button",{onClick:()=>Pe(!0),disabled:B||!I.trim()||I.length>2e3,className:"flex-[2] py-3 bg-[var(--btn-bg)] active:[--btn-bg:color-mix(in_srgb,var(--accent-primary)_80%,transparent)] transition-colors hover:bg-white/20 transition-all text-white font-black rounded-xl flex items-center justify-center gap-2 shadow-lg text-xs cursor-pointer",style:{color:"var(--accent-text)","--btn-bg":"var(--accent-primary)"},children:[B?e.jsx(Ye,{size:14,className:"animate-spin"}):e.jsx(be,{size:14})," ",L?"재분석":"서사 분석"]})]})]})]})]}):e.jsxs("button",{onClick:()=>{s(!0),setTimeout(()=>{var t;return(t=ze.current)==null?void 0:t.focus()},100)},className:"w-full p-8 md:p-12 rounded-[2rem] md:rounded-[2.5rem] border-2 border-dashed border-white/10 hover:border-[var(--accent-primary)] hover:bg-black-500/5 transition-all flex flex-col items-center justify-center gap-4 group",children:[e.jsx("div",{className:"p-4 rounded-full bg-white/5 group-hover:scale-110 transition-transform",children:e.jsx(Te,{size:32,style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"}})}),e.jsx("span",{className:"text-base md:text-lg font-black opacity-40 group-hover:opacity-100",style:{color:"var(--text-primary)"},children:"새로운 서사 기록하기"})]})}),e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4",children:[e.jsxs("div",{className:"flex items-center gap-3 opacity-30",children:[e.jsx("span",{className:"text-[12px] font-black uppercase tracking-[0.1em]",children:"기록된 서사"}),e.jsx("div",{className:"w-12 md:w-24 h-[1px] bg-white/20"})]}),e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1.5 bg-black/5 rounded-xl border border-white/5 shadow-inner",children:[e.jsx(dt,{size:12,className:"opacity-40"}),e.jsxs("select",{value:M,onChange:t=>te(t.target.value),className:"bg-transparent border-none p-0 text-[10px] font-black outline-none cursor-pointer",style:{color:Ct},children:[e.jsx("option",{value:"latest",className:"font-bold",style:{backgroundColor:"var(--bg-from)",color:"var(--text-primary)"},children:"날짜순"}),e.jsx("option",{value:"registration",className:"font-bold",style:{backgroundColor:"var(--bg-from)",color:"var(--text-primary)"},children:"등록순"})]})]})]}),ce.length===0?e.jsx("div",{className:"py-20 text-center opacity-30 italic font-bold",style:{color:"var(--text-primary)"},children:"기록된 서사가 없습니다."}):ce.map(t=>{var a,r;return e.jsxs("div",{id:`log-${t.id}`,className:"glass-panel p-6 md:p-8 rounded-[2rem] md:rounded-[2.5rem] border bg-white/[0.01] group hover:border-[var(--accent-primary)] transition-all shadow-lg",style:{borderColor:"var(--glass-border)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-[11px] font-black opacity-80",style:{color:"var(--text-primary)"},children:[t.date," ",t.time&&e.jsx("span",{className:"opacity-40 ml-1",children:t.time})]}),e.jsx("select",{value:t.categoryId,onChange:i=>vt(t.id,i.target.value),className:"bg-transparent border-none p-0 text-[10px] font-black text--[var(--accent-text)] outline-none cursor-pointer",children:$.map(i=>e.jsx("option",{value:i.id,className:"bg-slate-900",style:{backgroundColor:"var(--bg-from)",color:"var(--text-primary)"},children:i.name},i.id))})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[(t.characters||[]).map(i=>{var y,O;const g=(O=(y=t.analysis)==null?void 0:y.characterReactions)==null?void 0:O.find(X=>{var Y;return String(X.name).trim().toLowerCase()===String(i.name).trim().toLowerCase()||((Y=nt(String(X.name),b))==null?void 0:Y.name)===i.name}),k=g==null?void 0:g.stressLevel;return e.jsxs("button",{title:"속마음 확인하기",onClick:()=>Ke(i.name,t.id),className:"px-2 py-1 rounded-lg bg-indigo-500/10 border border-indigo-500/20 text-[10px] font-black text-indigo-400 hover:bg-indigo-500/20 transition-all flex items-center gap-1",children:[C(i.name).replace(/[\[\]]/g,""),k!==void 0&&e.jsxs("span",{className:`flex items-center gap-0.5 ml-1 border-l border-white/10 pl-2 ${parseInt(String(k))>=70?"text-rose-400":parseInt(String(k))>=40?"text-amber-400":"text-emerald-400"}`,children:["stress ",C(k),"%"]})]},i.name)}),e.jsx("div",{className:"pl-3",children:(r=(a=t.analysis)==null?void 0:a.keywords)==null?void 0:r.map((i,g)=>e.jsxs("span",{className:"text-[10px] font-black",style:{marginRight:"6px",color:"var(--accent-primary)"},children:["#",C(i)]},g))})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-3",children:[t.analysis&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-amber-500/10 px-3 py-1 rounded-full border border-amber-500/20",title:C(t.analysis.emotionalTone),children:[e.jsx(ts,{size:15,className:"text-white/60 fill-amber-500"}),e.jsx("span",{className:"text-[10px] font-black text-amber-500",title:C(t.analysis.emotionalTone),children:C(t.analysis.score)})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[p!=="all"&&e.jsx("button",{onClick:()=>jt(t),className:"p-2 text-indigo-400 hover:bg-indigo-400/10 rounded-lg transition-all",title:"수정",children:e.jsx(Ut,{size:14})}),e.jsx("button",{onClick:()=>wt(t.id),className:"p-2 text-rose-500 hover:bg-rose-500/10 rounded-lg transition-all",title:"삭제",children:e.jsx(tt,{size:14})})]})]})]}),e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsx(it,{text:C(t.content),label:"서사 원문",icon:e.jsx(ps,{size:10}),colorClass:"text-[var(--accent-primary)]"}),t.analysis&&e.jsxs("div",{className:"p-4 bg-black/10 rounded-[1.5rem] md:rounded-[2rem] border border-white/5 shadow-inner",style:{borderColor:"var(--glass-border)"},children:[e.jsx(it,{text:C(t.analysis.summary),label:"AI 요약",icon:e.jsx(js,{size:10}),colorClass:"text-[var(--accent-primary)]"}),e.jsx("span",{className:"inline-block h-px py-3 my-1 text-right text-[9px] font-black opacity-30",style:{color:"var(--text-primary)"},children:"이름 클릭하여 속마음 확인하기"})]})]})]},t.id)})]})]}),R==="analysis"&&e.jsx(Ds,{logs:ce,knownProfiles:He,onUpdateProfile:N,onNavigateToAnalysis:t=>{h(t)},focusTarget:pt},p),R==="trends"&&e.jsxs("div",{className:"h-full flex flex-col justify-center py-10 relative overflow-x-auto custom-scrollbar no-scrollbar px-4 md:px-12",ref:gt,children:[p==="all"?e.jsxs("div",{className:"glass-panel p-12 rounded-[2.5rem] border bg-indigo-500/5 flex flex-col items-center justify-center gap-4 text-center max-w-2xl mx-auto",style:{borderColor:"var(--glass-border)"},children:[e.jsx(Ie,{size:48,className:"text-indigo-400 opacity-40"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-black",style:{color:"var(--text-primary)"},children:"서사 카테고리를 선택하세요"}),e.jsx("p",{className:"text-sm opacity-50",style:{color:"var(--text-primary)"},children:"타임라인 분석은 개별 카테고리 화면에서만 가능합니다."})]})]}):e.jsxs("div",{className:"relative min-w-max flex items-center h-[450px]",children:[e.jsx("div",{className:" absolute left-0 right-0 h-1 bg-gradient-to-r from-[color-mix(in_srgb,var(--accent-primary),transparent_90%)] via-[var(--accent-primary)] to-[color-mix(in_srgb,var(--accent-primary),transparent_90%)] top-1/2 -translate-y-1/2 opacity-40 "}),e.jsx("div",{className:"flex items-center gap-48 relative px-32",children:bt.map((t,a)=>{var k;const r=(k=t.analysis)==null?void 0:k.score,i=typeof r=="number"?r:50,g=i>=80?"#10b981":i>=70?"#84e259":i>=60?"#facc15":i>=50?"#7dc3d4":i>=40?"#3b82f6":i>=30?"#b23bf6":i>=20?"#f43f5e":"#545455";return e.jsxs("div",{className:"relative group cursor-pointer flex flex-col items-center",onClick:()=>V(t),children:[e.jsxs("div",{className:`absolute ${a%2===0?"top-[-35px]":"bottom-[-35px]"} text-[10px] font-black opacity-60 whitespace-nowrap bg-indigo-500/10 px-3 py-1 rounded-full border border-indigo-500/20 flex items-center gap-1.5`,style:{color:"var(--text-primary)"},children:[e.jsx(ye,{size:10})," ",t.date]}),e.jsx("div",{className:"w-3 h-3 rounded-full border-2 shadow-2xl transition-all duration-300 group-hover:scale-150 z-10",style:{backgroundColor:g,borderColor:"var(--bg-from)"}}),e.jsx("div",{className:`absolute ${a%2===0?"bottom-[calc(50%+45px)]":"top-[calc(50%+45px)]"} flex flex-col items-center w-40 text-center space-y-4`,children:e.jsx("div",{className:"glass-panel px-2 py-4 rounded-[2rem] border bg-white/5 group-hover:border-indigo-500 transition-all shadow-xl w-full hover:scale-105 duration-300",style:{borderColor:"var(--glass-border)"},children:e.jsxs("div",{className:"flex flex-wrap justify-center gap-1.5",children:[(t.characters||[]).map(y=>e.jsxs("span",{className:"px-2 py-0.5 rounded-lg text-[9px] font-black flex items-center gap-1",style:{backgroundColor:"var(--accent-primary)",color:"var(--accent-text)"},children:[e.jsx(et,{size:8})," ",C(y.name).replace(/[\[\]]/g,"")]},y.name)),(!t.characters||t.characters.length===0)&&e.jsx("span",{className:"text-[10px] font-bold opacity-30",children:"등장인물 없음"})]})})})]},t.id)})})]}),T&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 md:p-8 bg-black/50 backdrop-blur-md animate-fade-in",onClick:()=>V(null),children:e.jsxs("div",{className:"relative w-full max-w-2xl glass-panel p-6 md:p-10 rounded-[2.5rem] md:rounded-[3.5rem] shadow-2xl border flex flex-col gap-8",style:{borderColor:"var(--glass-border)",backgroundColor:"var(--glass-bg)"},onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>V(null),className:"absolute top-6 right-6 md:top-8 md:right-8 p-3 rounded-full hover:bg-white/10 transition-colors",style:{color:"white"},children:e.jsx(ge,{size:24})}),e.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 pb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-black text-indigo-500 mb-2 uppercase tracking-widest",style:{color:"var(--accent-primary)"},children:[T.date," ",T.time]}),e.jsx("h2",{className:"text-xl md:text-2xl font-black text-white",children:"서사 기록 상세"})]}),e.jsxs("div",{className:"text-lg md:text-[10px] font-black text-amber-500 flex items-center gap-2 bg-amber-500/10 mx-10 my-4 px-3 py-2 rounded-2xl",style:{backgroundColor:"transparent",color:"var(--accent-primary)"},children:[e.jsx(ct,{size:14,fill:"currentColor"}),"서사점수 ",C(((Ge=T.analysis)==null?void 0:Ge.score)||0),"점"]})]}),e.jsxs("div",{className:"space-y-8 overflow-y-auto custom-scrollbar pr-4 max-h-[55vh] text-white",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-[10px] font-black opacity-30 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(at,{size:12})," 인물"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(T.characters||[]).map(t=>e.jsxs("button",{onClick:()=>{Ke(t.name,T.id)},className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-xs font-black hover:bg-indigo-500/20 transition-all flex items-center gap-2",children:[e.jsx(et,{size:12,className:"text-indigo-400",style:{color:"var(--accent-primary)",fill:"var(--accent-primary)"}})," ",C(t.name).replace(/[\[\]]/g,"")]},t.name))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-[10px] font-black opacity-30 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(be,{size:12})," AI 요약"]}),e.jsx("p",{className:"text-base md:text-lg font-bold leading-relaxed",children:C((Ze=T.analysis)==null?void 0:Ze.summary)})]}),((Qe=T.analysis)==null?void 0:Qe.keywords)&&e.jsx("div",{className:"flex flex-wrap gap-2",children:T.analysis.keywords.map((t,a)=>e.jsxs("span",{className:"text-[11px] font-black text-indigo-400 hover:bg-indigo-500/20  px-2 py-1 rounded-lg border border-indigo-500/20 flex items-center gap-1",style:{color:"var(--accent-primary)"},children:[e.jsx(xt,{size:10}),C(t)]},a))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-[10px] font-black opacity-30 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(rt,{size:12})," 기록 원문"]}),e.jsxs("p",{className:"text-sm italic opacity-80 border-l-4 border-l-[var(--accent-primary)] pl-6 py-2 leading-relaxed whitespace-pre-wrap",children:['"',C(T.content),'"']})]})]})]})})]})]})]})]})};export{Hs as default};
